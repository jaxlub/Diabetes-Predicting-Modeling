---
title: "Final_Project"
author: "Jax Lubkowitz"
format: html
editor: visual
---

```{r}
library(tidyverse)
library(shiny)
data <- read.csv('/Users/jaxlub/Downloads/diabetes.csv')

data_pos <- data |> filter(Outcome == 1) 
data_neg <- data |> filter(Outcome == 0) 

ggplot(data = data, aes(x = BMI, y = Age, color = Outcome)) +
  geom_point()
ggplot(data = data, aes(x = Glucose, y = Insulin, color = Outcome)) +
  geom_point()
ggplot(data = data, aes(x = DiabetesPedigreeFunction, y = Pregnancies, color = Outcome)) +
  geom_point()
ggplot(data = data, aes(x = SkinThickness, y = BloodPressure, color = Outcome)) +
  geom_point()
```



# Shiny App
```{r}
columns = c("Pregnancies", "Glucose", "BloodPressure", "SkinThickness", "Insulin",  "BMI", "DiabetesPedigreeFunction", "Age")

ui <- fluidPage(
  tabsetPanel(
    tabPanel("Data", fluid = TRUE,
             sidebarLayout(
               sidebarPanel(
                 selectInput("xaxis", 
                             label = "Select Predictor of Interest", 
                             choices = columns)),
               mainPanel(
                 plotOutput("histogram_neg"),
                 plotOutput("histogram_pos")
               )
             )
    )
  )
)

server <- function(input, output, session) {

    observeEvent(input$island,{
    spec_choices <- penguins |> 
      filter(island == input$island) |>
      mutate(species = factor(species)) |> 
      pull(species) |> 
      levels()
    updateSelectInput(inputId = "species", choices = spec_choices)
  })
  
  output$histogram_neg <- renderPlot({
    ggplot(data = data_neg, aes(x = .data[[input$xaxis]])) +
      geom_histogram(fill = "cornflowerblue", color = "black") + 
      labs(title = glue::glue(input$xaxis," Distribution in Non-Diabetic Patients")) + 
      theme_minimal()
  })
  output$histogram_pos <- renderPlot({
    ggplot(data = data_pos, aes(x = .data[[input$xaxis]])) +
      geom_histogram(fill = "firebrick1", color = "black") + 
      labs(title = glue::glue(input$xaxis," Distribution in Diabetic Patients")) + 
      theme_minimal()
  })
}

shinyApp(ui, server)
```

